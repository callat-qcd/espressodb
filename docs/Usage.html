

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>How to use EspressoDB &mdash; EspressoDB 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference of EspressoDB" href="api/index.html" />
    <link rel="prev" title="EspressoDB" href="README.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> EspressoDB
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">EspressoDB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="README.html#description">Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#install">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#authors">Authors</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">How to use EspressoDB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tl-dr">TL;DR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#details">Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#start-a-project">Start a project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-the-database-and-tables">Create the database and tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-a-new-app">Create a new app</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-your-models-in-external-modules">Using your models in external modules</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">API Reference of EspressoDB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/base/index.html"><code class="docutils literal notranslate"><span class="pre">espressodb.base</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/base/models.html"><code class="docutils literal notranslate"><span class="pre">models</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EspressoDB</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>How to use EspressoDB</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/usage.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="how-to-use-espressodb">
<h1>How to use EspressoDB<a class="headerlink" href="#how-to-use-espressodb" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This section explains how to use EspressoDB to create apps.
It provides a wrapper interface for <a class="reference external" href="https://docs.djangoproject.com/en/2.2/intro/tutorial01/#creating-a-project"><code class="docutils literal notranslate"><span class="pre">djangos</span></code> project creation</a> which automatically installs EspressoDB apps.</p>
</div>
<div class="section" id="tl-dr">
<h2>TL;DR<a class="headerlink" href="#tl-dr" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Create a new project: <code class="docutils literal notranslate"><span class="pre">espressodb</span> <span class="pre">startproject</span> <span class="pre">my_project;</span> <span class="pre">cd</span> <span class="pre">my_project</span></code></p>
<ul class="simple">
<li><p>(Optional) Configure the project infos in <code class="docutils literal notranslate"><span class="pre">db-config.yaml</span></code> and <code class="docutils literal notranslate"><span class="pre">settings.yaml</span></code></p></li>
<li><p>(Optional) Create a new app <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">startapp</span> <span class="pre">my_app</span></code> and configure it and create new migrations
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">makemigrations</span></code></p></li>
</ul>
</li>
<li><p>Migrate the tables to the database <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">migrate</span></code></p>
<ul class="simple">
<li><p>(Optional) Launch a local web server <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">runserver</span></code></p></li>
<li><p>(Optional) Install your project locally  <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--user</span> <span class="pre">-e</span> <span class="pre">.</span></code></p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="details">
<h2>Details<a class="headerlink" href="#details" title="Permalink to this headline">¶</a></h2>
<div class="section" id="start-a-project">
<h3>Start a project<a class="headerlink" href="#start-a-project" title="Permalink to this headline">¶</a></h3>
<p>A project is the root module which manages the settings for your (future) tables like connections to the database, security levels and so on.</p>
<p>You can initialize an empty project by running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>espressodb startproject my_project
</pre></div>
</div>
<p>This will create the following folder structure</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>my_project/
<span class="p">|</span>-- manage.py
<span class="p">|</span>-- db-config.yaml
<span class="p">|</span>-- settings.yaml
<span class="p">|</span>-- setup.py
<span class="p">|</span>-- my_project/
    <span class="p">|</span>-- __init__.py
    <span class="p">|</span>-- config/
        <span class="p">|</span>-- __init__.py
        <span class="p">|</span>-- settings.py
        <span class="p">|</span>-- urls.py
        <span class="p">|</span>-- wsgi.py
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">settings.yaml</span></code> and <code class="docutils literal notranslate"><span class="pre">db-config.yaml</span></code> are convenience files which are imported in the <code class="docutils literal notranslate"><span class="pre">settings.py</span></code> file.
Both of them may contain passwords (<code class="docutils literal notranslate"><span class="pre">SECRET_KEY</span></code> in the <code class="docutils literal notranslate"><span class="pre">settings</span></code> and database <code class="docutils literal notranslate"><span class="pre">PASSWORD</span></code> in the db config) and thus you should pay attention if or with whom you want to share them.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">db-config.yaml</span></code> provides the <code class="docutils literal notranslate"><span class="pre">default</span></code> database option.
As a start, it uses a <code class="docutils literal notranslate"><span class="pre">sqlite</span></code> database.
You can specify different options like a <code class="docutils literal notranslate"><span class="pre">postgres</span></code> model in here (see also the <a class="reference external" href="https://docs.djangoproject.com/en/dev/ref/settings/#databases">docs</a>).</p>
</div>
<div class="section" id="create-the-database-and-tables">
<h3>Create the database and tables<a class="headerlink" href="#create-the-database-and-tables" title="Permalink to this headline">¶</a></h3>
<p>After you have created a project for the first time, you have to initialize your tables.
Django provides an interface to manage the communication with the database without you running any SQL commands directly.
Specifically, you can program python classes, which specify a given table layout, and know how to talk to a database.
These classes are called models and have a one-to-one correspondence to tables within the database.
By default django provides a few basic models like the <code class="docutils literal notranslate"><span class="pre">User</span></code> class.</p>
<p>Updating the database with new tables or modifying old ones is a crucial step.
If the python backend encounters tables which do not match what the user specified, this could cause the ORM to fail.
To ensure table and code updates are executed in a consistent way django implements the following two-step procedure:</p>
<ol class="simple">
<li><p>Once the python models have been updated, django identifies a strategy how the existing tables within the DB must be adjusted to match the new specifications.
E.g., if a column was added, how to populate old entries which did not have this column.
In this step, the database is not touched yet and <code class="docutils literal notranslate"><span class="pre">migration</span></code> files are created.
You start this procedure by running</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">makemigrations</span>
</pre></div>
</div>
<p>If this fails, nothing crucial has happend yet.
However you should make sure that before continuing, everything works as expected.</p>
<ol class="simple">
<li><p>To update the database, you have to <code class="docutils literal notranslate"><span class="pre">migrate</span></code> changes.
This applies the specifications in the <code class="docutils literal notranslate"><span class="pre">migration</span></code> files and alters your database.
To apply the migrations run</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py migrate
</pre></div>
</div>
<p>After successfully migrating new or updated models, you can start using your project by, e.g., launching the web interface:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py runserver
</pre></div>
</div>
</div>
<div class="section" id="create-a-new-app">
<h3>Create a new app<a class="headerlink" href="#create-a-new-app" title="Permalink to this headline">¶</a></h3>
<p>To start a new app, the sub module for new tables, run the following command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py startapp my_app
</pre></div>
</div>
<p>This will create the new folders and files</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>my_project/
<span class="p">|</span>-- my_app/
    <span class="p">|</span>-- __init__.py
    <span class="p">|</span>-- admin.py
    <span class="p">|</span>-- apps.py
    <span class="p">|</span>-- models.py
    <span class="p">|</span>-- tests.py
    <span class="p">|</span>-- views.py
    <span class="p">|</span>-- templates/
    <span class="p">|</span>-- migrations/
        <span class="p">|</span>-- __init__.py
</pre></div>
</div>
<p>To let your project know that it also has to run the new app, change the <code class="docutils literal notranslate"><span class="pre">settings.yaml</span></code> to also include</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PROJECT_APPS</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">my_project</span><span class="o">.</span><span class="n">my_app</span>
</pre></div>
</div>
<p>Because the project is empty, nothing significant has changed thus far.</p>
<p>To implement your first table, you must adjust the models file.
E.g., to create a table which works with the <code class="docutils literal notranslate"><span class="pre">EspressoDB</span></code> default features, update <code class="docutils literal notranslate"><span class="pre">my_app/models.py</span></code> to</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">espressodb.base.models</span> <span class="kn">import</span> <span class="n">Base</span>

<span class="k">class</span> <span class="nc">MyTable</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>This implements a new model with the default columns provided by the <code class="docutils literal notranslate"><span class="pre">EspressoDB</span></code> base model (e.g., <code class="docutils literal notranslate"><span class="pre">user</span></code>, <code class="docutils literal notranslate"><span class="pre">last_modified</span></code>,  <code class="docutils literal notranslate"><span class="pre">tag</span></code>, <code class="docutils literal notranslate"><span class="pre">type</span></code>, <code class="docutils literal notranslate"><span class="pre">misc</span></code>).</p>
<p>To update your database you have to (again) create and migrate <code class="docutils literal notranslate"><span class="pre">migrations</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py makemigrations
python manage.py migrate
</pre></div>
</div>
<p>After this, you should be able to see a  <em>My Table</em>  entry within the documentation</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py runserver
</pre></div>
</div>
<p>and visit <a class="reference external" href="http://127.0.0.1:8000/documentation/my_app/">http://127.0.0.1:8000/documentation/my_app/</a>.</p>
<p>For implementing more sophisticated tables, see also the <a class="reference external" href="https://docs.djangoproject.com/en/2.2/topics/db/models/">django model documentation</a>.</p>
<blockquote>
<div><blockquote>
<div><blockquote>
<div><p>Note that you have to replace <code class="docutils literal notranslate"><span class="pre">models.Model</span></code> with <code class="docutils literal notranslate"><span class="pre">EspressoDB</span></code>s <code class="docutils literal notranslate"><span class="pre">Base</span></code>.
<code class="docutils literal notranslate"><span class="pre">Base</span></code> derives from django’s default <code class="docutils literal notranslate"><span class="pre">models.Model</span></code> but provides further features needed by <code class="docutils literal notranslate"><span class="pre">EspressoDB</span></code>.</p>
</div></blockquote>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="using-your-models-in-external-modules">
<h3>Using your models in external modules<a class="headerlink" href="#using-your-models-in-external-modules" title="Permalink to this headline">¶</a></h3>
<p>The easiest way to let your other python modules use these tables is to install your project as a pip moduel (not on a python index page, just in your local path).
To do so take a look at <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>, adjust it to your means and run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="p">[</span><span class="o">--</span><span class="n">user</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">e</span><span class="p">]</span> <span class="o">.</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">[-e]</span></code> options symlinks the install against this folder and can be useful incase you want to continue updating this module, e.g., for development purposes.
That’s it.
You can now use your tables in any python program like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">my_project.my_app.models</span> <span class="kn">import</span> <span class="n">MyTable</span>

<span class="n">all_entries</span> <span class="o">=</span> <span class="n">MyTable</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

<span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">all_entries</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
</pre></div>
</div>
<p>See also the <a class="reference external" href="https://docs.djangoproject.com/en/2.2/topics/db/queries/">django query docs</a> for more sophisticated options.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api/index.html" class="btn btn-neutral float-right" title="API Reference of EspressoDB" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="README.html" class="btn btn-neutral float-left" title="EspressoDB" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Christopher Körber, Jason Chang

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>