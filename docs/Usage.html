

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>How to use EspressoDB &mdash; EspressoDB 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The example project" href="example/index.html" />
    <link rel="prev" title="EspressoDB" href="README.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> EspressoDB
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">EspressoDB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="README.html#what-does-espressodb-provide">What does EspressoDB provide?</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#how-to-install-it">How to install it?</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#what-s-the-story-behind-it">What’s the story behind it?</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#who-is-responsible-for-it">Who is responsible for it?</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">How to use EspressoDB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tl-dr">TL;DR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#details">Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#install-espressodb">Install EspressoDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#start-a-project">Start a project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configure-your-project">Configure your project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-or-update-the-database">Create or update the database</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#create-migrations">Create migrations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#migrate-changes">Migrate changes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#launch-a-local-web-app">Launch a local web app</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-a-new-app">Create a new app</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install-your-project-locally">Install your project locally</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="example/index.html">The example project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="example/project-viewcase/index.html">What can I do?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="example/project-viewcase/install.html">Install the project</a></li>
<li class="toctree-l3"><a class="reference internal" href="example/project-viewcase/public-views.html">The public views</a><ul>
<li class="toctree-l4"><a class="reference internal" href="example/project-viewcase/public-views.html#the-home-page">The home page</a></li>
<li class="toctree-l4"><a class="reference internal" href="example/project-viewcase/public-views.html#the-doc-page">The doc page</a></li>
<li class="toctree-l4"><a class="reference internal" href="example/project-viewcase/public-views.html#the-population-views">The population views</a></li>
<li class="toctree-l4"><a class="reference internal" href="example/project-viewcase/public-views.html#the-login-page">The login page</a></li>
<li class="toctree-l4"><a class="reference internal" href="example/project-viewcase/public-views.html#the-hamiltonian-status-page">The Hamiltonian status page</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="example/project-viewcase/private-views.html">The private views</a><ul>
<li class="toctree-l4"><a class="reference internal" href="example/project-viewcase/private-views.html#the-notifications-page">The notifications page</a></li>
<li class="toctree-l4"><a class="reference internal" href="example/project-viewcase/private-views.html#the-admin-pages">The admin pages</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="example/project-viewcase/external-scripts.html">Using your project in external modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="example/project-viewcase/external-scripts.html#installing-your-module">Installing your module</a></li>
<li class="toctree-l4"><a class="reference internal" href="example/project-viewcase/external-scripts.html#using-tables">Using tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="example/project-viewcase/external-scripts.html#the-add-data-py-script">The <code class="docutils literal notranslate"><span class="pre">add_data.py</span></code> script</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="example/project-creation/index.html">How do I set up the example project myself?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="example/project-creation/project-creation.html">Create your own project</a><ul>
<li class="toctree-l4"><a class="reference internal" href="example/project-creation/project-creation.html#start-the-project">Start the project</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="example/project-creation/app-creation.html">Create the hamiltonians app</a><ul>
<li class="toctree-l4"><a class="reference internal" href="example/project-creation/app-creation.html#creating-the-infrastructure">Creating the infrastructure</a></li>
<li class="toctree-l4"><a class="reference internal" href="example/project-creation/app-creation.html#creating-tables">Creating tables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="example/project-creation/adding-data.html">Adding data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="example/project-creation/adding-data.html#the-admin-page">The admin page</a></li>
<li class="toctree-l4"><a class="reference internal" href="example/project-creation/adding-data.html#data-scripts">Data scripts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="example/project-creation/class-interface.html">Providing short cuts with class methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="example/project-creation/dependencies.html">Adding tables with relationships</a><ul>
<li class="toctree-l4"><a class="reference internal" href="example/project-creation/dependencies.html#updating-the-models">Updating the models</a></li>
<li class="toctree-l4"><a class="reference internal" href="example/project-creation/dependencies.html#updating-the-run-script">Updating the run script</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="example/project-creation/views.html">Creating web views for summaries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="example/project-creation/views.html#adjusting-the-index-template">Adjusting the index template</a></li>
<li class="toctree-l4"><a class="reference internal" href="example/project-creation/views.html#views-with-plots">Views with plots</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="example/project-creation/inheritance.html">More complicated tables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="example/project-creation/inheritance.html#in-which-scenario-are-they-helpful">In which scenario are they helpful</a></li>
<li class="toctree-l4"><a class="reference internal" href="example/project-creation/inheritance.html#implementation-of-common-base">Implementation of common base</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="features/index.html">Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="features/base.html">Base</a></li>
<li class="toctree-l2"><a class="reference internal" href="features/documentation.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="features/management.html">Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="features/notifications.html">The notifications module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">API Reference of EspressoDB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/base/index.html">espressodb.base</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/base/admin.html">admin</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/base/models.html">models</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/base/static.html">static</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/base/urls.html">urls</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/base/views.html">views</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/base/utilities/index.html">utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/base/utilities/apps.html">apps</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/base/utilities/blackmagicsorcery.html">blackmagicsorcery</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/base/utilities/models.html">models</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/base/templatetags/index.html">templatetags</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/base/templatetags/base_extras.html">base_extras</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/documentation/index.html">espressodb.documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/documentation/urls.html">urls</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/documentation/views.html">views</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/documentation/templatetags/index.html">templatetags</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/documentation/templatetags/documentation_extras.html">documentation_extras</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/notifications/index.html">espressodb.notifications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/notifications/models.html">models</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/notifications/urls.html">urls</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/notifications/views.html">views</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/notifications/templatetags/index.html">templatetags</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/notifications/templatetags/notification_extras.html">notifications_extras</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/management/index.html">espressodb.management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/management/utilities/index.html">utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/management/utilities/files.html">files</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/management/utilities/settings.html">settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/management/utilities/version.html">version</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/management/management_commands/index.html">commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/management/management_commands/info.html">info</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/management/management_commands/startapp.html">startapp</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/management/management_commands/startproject.html">startproject</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/summary.html">Summary of EspressoDB functionality</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/summary.html#urls">URLs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/summary.html#module-espressodb-base-urls"><strong>Module</strong>: <code class="xref py py-mod docutils literal notranslate"><span class="pre">espressodb.base.urls</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/summary.html#module-espressodb-documentation-urls"><strong>Module</strong>: <code class="xref py py-mod docutils literal notranslate"><span class="pre">espressodb.documentation.urls</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/summary.html#module-espressodb-notifications-urls"><strong>Module</strong>: <code class="xref py py-mod docutils literal notranslate"><span class="pre">espressodb.notifications.urls</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/summary.html#templatetags">Templatetags</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/summary.html#module-espressodb-base-templatetags-base-extras"><strong>Module</strong>: <code class="xref py py-mod docutils literal notranslate"><span class="pre">espressodb.base.templatetags.base_extras</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/summary.html#module-espressodb-documentation-templatetags-documentation-extras"><strong>Module</strong>: <code class="xref py py-mod docutils literal notranslate"><span class="pre">espressodb.documentation.templatetags.documentation_extras</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/summary.html#module-espressodb-notifications-templatetags-notifications-extras"><strong>Module</strong>: <code class="xref py py-mod docutils literal notranslate"><span class="pre">espressodb.notifications.templatetags.notifications_extras</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EspressoDB</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>How to use EspressoDB</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Usage.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="how-to-use-espressodb">
<h1>How to use EspressoDB<a class="headerlink" href="#how-to-use-espressodb" title="Permalink to this headline">¶</a></h1>
<p>This section explains how to use EspressoDB to create projects and apps.
It provides a wrapper interface for <a class="reference external" href="https://docs.djangoproject.com/en/2.2/intro/tutorial01/#creating-a-project"><code class="docutils literal notranslate"><span class="pre">djangos</span></code> project creation</a> which streamlines the creation process.</p>
<div class="section" id="tl-dr">
<h2>TL;DR<a class="headerlink" href="#tl-dr" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p><a class="reference external" href="#install-espressodb">Install EspressoDB</a></p></li>
<li><p><a class="reference external" href="#start-a-project">Create a new project</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>espressodb startproject my_project
</pre></div>
</div>
<p>The following commands must be run in the project root directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> my_project
</pre></div>
</div>
</li>
<li><p><em>(Optional)</em> <a class="reference external" href="#configure-your-project">Update the configurations of the project</a> in <code class="docutils literal notranslate"><span class="pre">db-config.yaml</span></code> and <code class="docutils literal notranslate"><span class="pre">settings.yaml</span></code></p></li>
<li><p><em>(Optional)</em> <a class="reference external" href="#create-a-new-app">Create a new app</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py startapp my_app
</pre></div>
</div>
<p>configure it and <a class="reference external" href="#create-migrations">create new migrations</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py makemigrations
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="#migrate-changes">Create or update the tables</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py migrate
</pre></div>
</div>
</li>
<li><p><em>(Optional)</em> <a class="reference external" href="#launch-a-local-web-app">Launch a local web app</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py runserver
</pre></div>
</div>
</li>
<li><p><em>(Optional)</em> <a class="reference external" href="#install-your-project-locally">Install your project locally</a> to use it in other modules</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="p">[</span><span class="o">--</span><span class="n">user</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">e</span><span class="p">]</span> <span class="o">.</span>
</pre></div>
</div>
</li>
</ol>
<p>For more details how to customize your project, take a look at the <a class="reference internal" href="example/project-creation/index.html"><span class="doc">how to create the example project</span></a> guide.</p>
</div>
<div class="section" id="details">
<h2>Details<a class="headerlink" href="#details" title="Permalink to this headline">¶</a></h2>
<div class="section" id="install-espressodb">
<h3>Install EspressoDB<a class="headerlink" href="#install-espressodb" title="Permalink to this headline">¶</a></h3>
<p>You can pip install this package by running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install <span class="o">[</span>--user<span class="o">]</span> espressodb
</pre></div>
</div>
<p>You can also install the project from source</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://www.github.com/callat-qcd/espressodb.git
<span class="nb">cd</span> espressodb
pip install <span class="o">[</span>--user<span class="o">]</span> <span class="o">[</span>-e<span class="o">]</span> .
</pre></div>
</div>
</div>
<div class="section" id="start-a-project">
<h3>Start a project<a class="headerlink" href="#start-a-project" title="Permalink to this headline">¶</a></h3>
<p>A project is the core module which manages the settings for your (future) tables like connections to the database, security levels and so on.</p>
<p>You can initialize an empty project by running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>espressodb startproject my_project
</pre></div>
</div>
<p>This will create the following folder structure</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>my_project/
<span class="p">|</span>-- manage.py
<span class="p">|</span>-- db-config.yaml
<span class="p">|</span>-- settings.yaml
<span class="p">|</span>-- setup.py
<span class="p">|</span>-- my_project/
    <span class="p">|</span>-- __init__.py
    <span class="p">|</span>-- config/
        <span class="p">|</span>-- __init__.py
        <span class="p">|</span>-- settings.py
        <span class="p">|</span>-- urls.py
        <span class="p">|</span>-- wsgi.py
        <span class="p">|</span>-- migrations/
            <span class="p">|</span>-- __init__.py
            <span class="p">|</span>-- notifications/
                <span class="p">|</span>-- __init__.py
                <span class="p">|</span>-- 0001_initial.py
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>EspressoDB makes use of the project structure by, e.g., finding import paths and static files.
Thus, unless you know what you are doing, it is recommended to stick to this folder layout.</p>
</div></div>
<div class="section" id="configure-your-project">
<h3>Configure your project<a class="headerlink" href="#configure-your-project" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">settings.yaml</span></code> and <code class="docutils literal notranslate"><span class="pre">db-config.yaml</span></code> are convenience files for easy updates (without accidentally committing secret passwords).
Both of them may contain passwords (<code class="docutils literal notranslate"><span class="pre">SECRET_KEY</span></code> in the <code class="docutils literal notranslate"><span class="pre">settings</span></code> and database <code class="docutils literal notranslate"><span class="pre">PASSWORD</span></code> in the db config) and thus you should pay attention if or with whom you want to share them.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">db-config.yaml</span></code> provides the <code class="docutils literal notranslate"><span class="pre">default</span></code> database option</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ENGINE</span><span class="p">:</span> <span class="n">django</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">sqlite3</span>
<span class="n">NAME</span><span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">my_project</span><span class="o">/</span><span class="n">db</span><span class="o">-</span><span class="n">config</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<p>The first option specifies the database backend.
As default, it uses the file based <code class="docutils literal notranslate"><span class="pre">sqlite</span></code> database.
For this case, the name points to the absolute path of the file (which allows interface for external apps).
You can specify different database options like a <code class="docutils literal notranslate"><span class="pre">postgres</span></code> model in this file (see also the <a class="reference external" href="https://docs.djangoproject.com/en/dev/ref/settings/#databases">docs</a>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">settings.yaml</span></code> specifies the database encryption, which [apps](Create a new app) your projects will use and, in case you want to, how you want to run the web server</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SECRET_KEY</span><span class="p">:</span> <span class="s2">&quot;Sup3r_compl1cated-P4ssw0rd!&quot;</span>
<span class="n">PROJECT_APPS</span><span class="p">:</span> <span class="p">[]</span>
<span class="n">ALLOWED_HOSTS</span><span class="p">:</span> <span class="p">[]</span>
<span class="n">DEBUG</span><span class="p">:</span> <span class="kc">True</span>
</pre></div>
</div>
<p>Both files are needed and eventually imported by <code class="docutils literal notranslate"><span class="pre">my_project/my_project/config/settings.py</span></code>.
If you want to learn more or have different setups, feel free to adjust this file with help of the <a class="reference external" href="https://docs.djangoproject.com/en/dev/ref/settings/">settings documentation</a>.</p>
</div>
<div class="section" id="create-or-update-the-database">
<h3>Create or update the database<a class="headerlink" href="#create-or-update-the-database" title="Permalink to this headline">¶</a></h3>
<p>After you have created a project for the first time, you have to initialize your tables.
Django provides an interface to manage the communication with the database without you running any SQL commands directly.
Specifically, you can program Python classes, which specify a given table layout, and know how to talk to a database.
This concept is called Object-Relational Mapping (ORM).
These classes are called models and have a one-to-one correspondence to tables within the database.
By default django provides a few basic models like the <code class="docutils literal notranslate"><span class="pre">User</span></code> class.</p>
<p>Updating the database with new tables or modifying old ones is a crucial step.
If the Python backend encounters tables which do not match what the user specified, this could cause the ORM to fail.
To ensure table and code updates are executed in a consistent way django, implements the following two-step procedure:</p>
<div class="section" id="create-migrations">
<h4>Create migrations<a class="headerlink" href="#create-migrations" title="Permalink to this headline">¶</a></h4>
<p>Once the Python models have been updated, django identifies a strategy how the existing tables within the DB must be adjusted to match the new specifications.
E.g., if a column was added, how to populate old entries which did not have this column yet.
If a change is implemented which needs user input, django will ask you how to proceed.
This update strategy will be summarized in a <code class="docutils literal notranslate"><span class="pre">migration</span></code> file.
You start this procedure by running</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">makemigrations</span>
</pre></div>
</div>
<p>In this step, the database is not modified.
So if this step fails, nothing crucial has happened yet.
However you should make sure that before continuing, everything works as expected.</p>
</div>
<div class="section" id="migrate-changes">
<h4>Migrate changes<a class="headerlink" href="#migrate-changes" title="Permalink to this headline">¶</a></h4>
<p>To update the database, you have to <code class="docutils literal notranslate"><span class="pre">migrate</span></code> changes.
This applies the specifications in the <code class="docutils literal notranslate"><span class="pre">migration</span></code> files and alters your database.
To apply the migrations run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py migrate
</pre></div>
</div>
<p>After successfully migrating new or updated models, you are good to go and can for example <a class="reference external" href="#launch-a-local-web-app">launch a web app</a>.</p>
<p>For further <a class="reference external" href="https://docs.djangoproject.com/en/dev/topics/migrations/">migration strategies, see also the django docs</a>.</p>
</div>
</div>
<div class="section" id="launch-a-local-web-app">
<h3>Launch a local web app<a class="headerlink" href="#launch-a-local-web-app" title="Permalink to this headline">¶</a></h3>
<p>Django provides an easy interface to launch a local web server.
Once you project is set up, you can run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">runserver</span>
</pre></div>
</div>
<p>to start a local lightweight server which runs by default on localhost: <a class="reference external" href="http://127.0.0.1:8000/">http://127.0.0.1:8000/</a>.
EspressoDB provides default views, meaning once your tables have been successfully migrated, you can directly see your project home page.
Everyone who has access to this port on your machine can access the launched web page.
This means, by default, you are the only one able to see it.</p>
</div>
<div class="section" id="create-a-new-app">
<h3>Create a new app<a class="headerlink" href="#create-a-new-app" title="Permalink to this headline">¶</a></h3>
<p>Apps are submodules within your project and implement new tables and other features.
To start a new app, run the following command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py startapp my_app
</pre></div>
</div>
<p>This will create the new folders and files</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>my_project/
<span class="p">|</span>-- my_app/
    <span class="p">|</span>-- __init__.py
    <span class="p">|</span>-- admin.py
    <span class="p">|</span>-- apps.py
    <span class="p">|</span>-- models.py
    <span class="p">|</span>-- tests.py
    <span class="p">|</span>-- views.py
    <span class="p">|</span>-- templates/
    <span class="p">|</span>-- migrations/
        <span class="p">|</span>-- __init__.py
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>
    EspressoDB makes use of the project and app structure by, e.g., finding import paths and static files.
    Thus, unless you know what you are doing, it is recommended to stick to this folder layout.
</p>
</div><p>To let your project know that it also has to include the new app, change the <code class="docutils literal notranslate"><span class="pre">settings.yaml</span></code> to also include</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PROJECT_APPS</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">my_project</span><span class="o">.</span><span class="n">my_app</span>
</pre></div>
</div>
<p>Because the project is empty, nothing significant has changed thus far.</p>
<p>To implement your first table, you must adjust the app models.
E.g., to create a table which works with the EspressoDB default features, update <code class="docutils literal notranslate"><span class="pre">my_project/my_app/models.py</span></code> to</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">espressodb.base.models</span> <span class="kn">import</span> <span class="n">Base</span>

<span class="k">class</span> <span class="nc">MyTable</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>This implements a new model with the default columns provided by the EspressoDB base model (e.g., <code class="docutils literal notranslate"><span class="pre">user</span></code>, <code class="docutils literal notranslate"><span class="pre">last_modified</span></code>, <code class="docutils literal notranslate"><span class="pre">tag</span></code>, <code class="docutils literal notranslate"><span class="pre">type</span></code>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>
    Note that you have to replace <code>models.Model</code> with EspressoDB's <code>Base</code>. <code>Base</code> derives from django's default <code>models.Model</code> but provides further features needed by EspressoDB.
</p>
</div><p>To update your database you have to (again) <a class="reference external" href="#create-or-update-the-database">create and migrate <code class="docutils literal notranslate"><span class="pre">migrations</span></code></a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py makemigrations
python manage.py migrate
</pre></div>
</div>
<p>After this, you should be able to see a  <em>My Table</em>  entry within the documentation</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py runserver
</pre></div>
</div>
<p>and visit <a class="reference external" href="http://127.0.0.1:8000/documentation/my_app/">http://127.0.0.1:8000/documentation/my_app/</a>.</p>
<p>For implementing more sophisticated tables, see also the <a class="reference external" href="https://docs.djangoproject.com/en/2.2/topics/db/models/">django model documentation</a>.</p>
</div>
<div class="section" id="install-your-project-locally">
<h3>Install your project locally<a class="headerlink" href="#install-your-project-locally" title="Permalink to this headline">¶</a></h3>
<p>The easiest way to let your other Python modules use these tables is to install your project as a pip module (not on Python package index, just in your local path).
To do so, take a look at <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>, <a class="reference external" href="https://docs.python.org/3.7/distutils/setupscript.html">adjust it to your means</a> and run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="p">[</span><span class="o">--</span><span class="n">user</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">e</span><span class="p">]</span> <span class="o">.</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">[-e]</span></code> options symlinks the install against this folder and can be useful incase you want to continue updating this module, e.g., for development purposes.</p>
<p>That’s it.</p>
<p>You can now use your tables in any Python program like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">my_project.my_app.models</span> <span class="kn">import</span> <span class="n">MyTable</span>

<span class="n">all_entries</span> <span class="o">=</span> <span class="n">MyTable</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

<span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">all_entries</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
</pre></div>
</div>
<p>See also the <a class="reference external" href="https://docs.djangoproject.com/en/2.2/topics/db/queries/">django query docs</a> for more sophisticated options.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="example/index.html" class="btn btn-neutral float-right" title="The example project" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="README.html" class="btn btn-neutral float-left" title="EspressoDB" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Christopher Körber, Jason Chang

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>