

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Adding data &mdash; EspressoDB 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Providing short cuts with class methods" href="class-interface.html" />
    <link rel="prev" title="Create the hamiltonians app" href="app-creation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> EspressoDB
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../README.html">EspressoDB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../README.html#what-does-espressodb-provide">What does EspressoDB provide?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../README.html#how-to-install-it">How to install it?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../README.html#what-s-the-story-behind-it">Whatâ€™s the story behind it?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../README.html#who-is-responsible-for-it">Who is responsible for it?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Usage.html">How to use EspressoDB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Usage.html#tl-dr">TL;DR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Usage.html#details">Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Usage.html#install-espressodb">Install EspressoDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Usage.html#start-a-project">Start a project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Usage.html#configure-your-project">Configure your project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Usage.html#create-or-update-the-database">Create or update the database</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Usage.html#launch-a-local-web-app">Launch a local web app</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Usage.html#create-a-new-app">Create a new app</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Usage.html#install-your-project-locally">Install your project locally</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">The example project</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../project-viewcase/index.html">What can I do?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project-viewcase/install.html">Install the project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project-viewcase/public-views.html">The public views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project-viewcase/private-views.html">The private views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project-viewcase/external-scripts.html">Using your project in external modules</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">How do I set up the example project myself?</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="project-creation.html">Create your own project</a></li>
<li class="toctree-l3"><a class="reference internal" href="app-creation.html">Create the hamiltonians app</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Adding data</a></li>
<li class="toctree-l3"><a class="reference internal" href="class-interface.html">Providing short cuts with class methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="dependencies.html">Adding tables with relationships</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html">Creating web views for summaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="inheritance.html">More complicated tables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../features/index.html">Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../features/base.html">Base</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../features/documentation.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../features/management.html">Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../features/notifications.html">The notifications module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Reference of EspressoDB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/base/index.html">espressodb.base</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/base/models.html">models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/base/static.html">static</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/base/templates.html">templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/base/templatetags.html">templatetags</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/base/utilities.html">utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/base/views.html">views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/documentation/index.html">espressodb.documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/documentation/templates.html">templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/documentation/templatetags.html">templatetags</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/documentation/views.html">views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/notifications/index.html">espressodb.notifications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/notifications/models.html">models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/notifications/templates.html">templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/notifications/templatetags.html">templatetags</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/notifications/views.html">views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/management/index.html">espressodb.management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/management/management.html">management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/management/utilities.html">utilities</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">EspressoDB</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">The example project</a> &raquo;</li>
        
          <li><a href="index.html">How do I set up the example project myself?</a> &raquo;</li>
        
      <li>Adding data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/example/project-creation/adding-data.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="adding-data">
<h1>Adding data<a class="headerlink" href="#adding-data" title="Permalink to this headline">Â¶</a></h1>
<p>This section shows you how to populate your database.</p>
<p>There are basically two options:</p>
<ol class="simple">
<li><p>you can use the admin page to adjust entries.</p></li>
<li><p>you can write your own script to add data.</p></li>
</ol>
<div class="section" id="the-admin-page">
<h2>The admin page<a class="headerlink" href="#the-admin-page" title="Permalink to this headline">Â¶</a></h2>
<p>To have access to the admin page, you should first create a super user.
This is done by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python manage.py createsuperuser
</pre></div>
</div>
<p>Once you have done that, you can see the admin area after <a class="reference external" href="http://127.0.0.1:8000/login/">logging in: http://127.0.0.1:8000/login/</a>.
E.g., your menu bar should have two more links: <a class="reference external" href="http://127.0.0.1:8000/notifications/">Notifications: http://127.0.0.1:8000/notifications/</a> and <a class="reference external" href="http://127.0.0.1:8000/admin/">admin: http://127.0.0.1:8000/admin/</a>.</p>
<p>On the admin page, you see a summary of all your tables.
Particularly, on the <a class="reference external" href="http://127.0.0.1:8000/admin/hamiltonian/contact/">contact hamiltonian admin: http://127.0.0.1:8000/admin/hamiltonian/contact/</a>, you find an empty table.
To create an entry, click on <a class="reference external" href="http://127.0.0.1:8000/admin/hamiltonian/contact/add/">add entry</a> and fill out the forms and save.
E.g., after choosing <code class="docutils literal notranslate"><span class="pre">n_sites=10</span></code>, <code class="docutils literal notranslate"><span class="pre">spacing=0.1</span></code> and <code class="docutils literal notranslate"><span class="pre">c=-1.0</span></code>, your table should look like this
<img alt="The first contact entry on the admin page" src="../../_images/example-create-first-entry.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>
    EspressoDB adds all models to the admin page by default.
    If you do not want to have this behavior, you have to adjust <code>my_project/hamiltonian/admin.py</code>
</p>
</div></div>
<div class="section" id="data-scripts">
<h2>Data scripts<a class="headerlink" href="#data-scripts" title="Permalink to this headline">Â¶</a></h2>
<p>Next we provide a script which adds missing data to the database.
To simplify this approach, EspressoDB provides <a class="reference external" href="http://127.0.0.1:8000/populate/">population views which help you code up scripts with nested dependencies</a>.
Since there is just one table without dependencies, the result is straight forward.
E.g., if you select <code class="docutils literal notranslate"><span class="pre">Contact[Base]</span></code>, you will obtain</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">my_project.hamiltonian.models</span> <span class="kn">import</span> <span class="n">Contact</span> <span class="k">as</span> <span class="n">hamiltonian_Contact</span>

<span class="n">hamiltonian_Contact</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span>
	<span class="n">n_sites</span><span class="o">=...</span><span class="p">,</span> <span class="c1"># Number of sites in one spatial dimension</span>
	<span class="n">spacing</span><span class="o">=...</span><span class="p">,</span> <span class="c1"># The lattice spacing between sites</span>
	<span class="n">c</span><span class="o">=...</span><span class="p">,</span> <span class="c1"># Interaction parameter of the Hamiltonian. Implements a contact interaction.</span>
	<span class="n">tag</span><span class="o">=...</span><span class="p">,</span> <span class="c1"># (Optional) User defined tag for easy searches</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In principle, you can just fill out the blanks and run this script.</p>
<p>We want to modify this script a little bit to emphasize the logic and a potential use case.</p>
<p>To do so, create the script <code class="docutils literal notranslate"><span class="pre">add_data.py</span></code> in the project root directory.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">my_project.hamiltonian.models</span> <span class="kn">import</span> <span class="n">Contact</span> <span class="k">as</span> <span class="n">ContactHamiltonian</span>

<span class="n">RANGES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;spacing&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="s2">&quot;n_sites&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">RANGES</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
        <span class="n">spacing</span><span class="p">,</span> <span class="n">n_sites</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">values</span>

        <span class="k">print</span><span class="p">(</span>
            <span class="s2">&quot;Start to compute eigenvalues for&quot;</span>
            <span class="n">f</span><span class="s2">&quot; spacing={spacing}, n_sites={n_sites} and c={c}.&quot;</span>
        <span class="p">)</span>

        <span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">ContactHamiltonian</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="n">n_sites</span><span class="o">=</span><span class="n">n_sites</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="n">spacing</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span>
        <span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">hamiltonian</span><span class="p">:</span>
            <span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">ContactHamiltonian</span><span class="p">(</span><span class="n">n_sites</span><span class="o">=</span><span class="n">n_sites</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="n">spacing</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;  Creating table entry for {hamiltonian}&quot;</span><span class="p">)</span>
            <span class="n">hamiltonian</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>With</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ContactHamiltonian</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">n_sites</span><span class="o">=</span><span class="n">n_sites</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="n">spacing</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
<p>we ask the database for all entries which fulfill the above criteria.
Since we have implenented a unique constrained, the returned <code class="docutils literal notranslate"><span class="pre">queryset</span></code> consists of either one or zero objects.
With the <code class="docutils literal notranslate"><span class="pre">first()</span></code> method we therefore receive a <code class="docutils literal notranslate"><span class="pre">ContactHamiltonian</span></code> instance or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>If we do not have an entry in the database, we want to create one.
First we want to create a Python instance.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">ContactHamiltonian</span><span class="p">(</span><span class="n">n_sites</span><span class="o">=</span><span class="n">n_sites</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="n">spacing</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
<p>This does not touch the database.
Only if we call save, the entry is inserted.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hamiltonian</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p>If this entry was present, this would raise an error because of the unique constrained.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>
    Django also provides a shortcut for this procedure with <code>ContactHamiltonian.objects.get_or_create</code>
    where an instance and a boolean is returned. The boolean is true whenever an entry was created.
</p>
</div><p>Once you run this script, you will populate your database</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ python add_data.py
Start to compute eigenvalues <span class="k">for</span> <span class="nv">spacing</span><span class="o">=</span><span class="m">0</span>.1, <span class="nv">n_sites</span><span class="o">=</span><span class="m">10</span> and <span class="nv">c</span><span class="o">=</span>-1.
Start to compute eigenvalues <span class="k">for</span> <span class="nv">spacing</span><span class="o">=</span><span class="m">0</span>.1, <span class="nv">n_sites</span><span class="o">=</span><span class="m">15</span> and <span class="nv">c</span><span class="o">=</span>-1.
  Creating table entry <span class="k">for</span> Contact<span class="o">[</span>Base<span class="o">](</span><span class="nv">n_sites</span><span class="o">=</span><span class="m">15</span>, <span class="nv">spacing</span><span class="o">=</span><span class="m">0</span>.1, <span class="nv">c</span><span class="o">=</span>-1<span class="o">)</span>
 ...
</pre></div>
</div>
<p>Because the first entry was already added by hand, it is skipped.
The rest will be inserted accordingly.
Now, you should be able to see 90 entries on the admin page.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="class-interface.html" class="btn btn-neutral float-right" title="Providing short cuts with class methods" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="app-creation.html" class="btn btn-neutral float-left" title="Create the hamiltonians app" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Christopher KÃ¶rber, Jason Chang

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>